From b2e2def5b5e264e98453a1914d7da731a7261801 Mon Sep 17 00:00:00 2001
From: chao zeng <chao.zeng@siemens.com>
Date: Fri, 15 Jul 2022 13:25:30 +0800
Subject: [PATCH 30/32] CVE-2022-0235

Ported from
OpenSuse:nodejs8-8.17.0-150200.10.22.1:CVE-2022-0235

Signed-off-by: chao zeng <chao.zeng@siemens.com>
---
 deps/npm/node_modules/node-fetch-npm/src/index.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/deps/npm/node_modules/node-fetch-npm/src/index.js b/deps/npm/node_modules/node-fetch-npm/src/index.js
index b2cf80f9ec..f83de8bac0 100644
--- a/deps/npm/node_modules/node-fetch-npm/src/index.js
+++ b/deps/npm/node_modules/node-fetch-npm/src/index.js
@@ -99,6 +99,9 @@ function fetch (uri, opts) {
         }
         if (url.parse(request.url).hostname !== redirectURL.hostname) {
           request.headers.delete('authorization')
+          request.headers.delete('www-authenticate')
+          request.headers.delete('cookie')
+          request.headers.delete('cookie2')
         }
 
         // per fetch spec, for POST request with 301/302 response, or any request with 303 response, use GET when following redirect
-- 
2.34.1

